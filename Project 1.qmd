---
title: "Project 1"
author: "Zach Ginder and Makenna Meyer"
format: pdf
editor: visual
---

```{r, warnings=FALSE}
#Load in libraries
library(tidyverse)
```

# Data Reading

```{r}
#| message: false
census_2010<-read_csv("https://www4.stat.ncsu.edu/~online/datasets/EDU01a.csv")
```

# Data Processing

## Question 1: Column Selection

```{r}
#Select columns with area name, STCOU, and any column that ends in D
selected_columns<-census_2010|> 
  select(Area_name, STCOU, ends_with("D"))|>
  rename(area_name=Area_name)
head(selected_columns, n=5L)

```

## Question 2: Long Format Conversion

```{r}
#Convert the tibble into long format
long_format<- selected_columns|> 
  pivot_longer(cols = ends_with("D"), names_to = "surveys")
head(long_format,n=5L)

#Function that does question 1 and 2
long_conversion<-function(tibble, value="values for enrollment"){
  long_format<- tibble|>
    select(Area_name, STCOU, ends_with("D"))|>
    rename(area_name=Area_name)|>
    pivot_longer(cols = ends_with("D"), names_to = "surveys")
  return(long_format)
}
```

## Question 3: Create Year and Measurement Columns

```{r}
#Parse the Survey column to create measurement and year columns
long_updated<-long_format|>
  mutate(years=as.numeric(substr(surveys,8,9)))|>
  mutate(years=ifelse(years<=25 & years>=0,years+2000,years+1900))|>
  mutate(measurements=substr(surveys,1,7))
head(long_updated,n=5L)

#Function that does question 3
surveys_year_measurements<-function(long_format){
  long_updated<-tibble|>
  mutate(years=as.numeric(substr(surveys,8,9)))|>
  mutate(years=ifelse(years<=25 & years>=0,years+2000,years+1900))|>
  mutate(measurements=substr(surveys,1,7))
  return(long_updated)
}
```
